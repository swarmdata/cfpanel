<!DOCTYPE html>
<html lang="en">
<link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Complaint Form</title>
  <style>
    /* Your existing styles here */
  </style>
</head>
<body>
  <div class="container">
    <h2>Got a complaint?</h2>
    <br><br>
    <!-- Star Rating Section -->
    <h3>Rate Your Experience</h3>
    <div class="stars">
      <span class="fa fa-star star" data-index="1"></span>
      <span class="fa fa-star star" data-index="2"></span>
      <span class="fa fa-star star" data-index="3"></span>
      <span class="fa fa-star star" data-index="4"></span>
      <span class="fa fa-star star" data-index="5"></span>
    </div>

    <p>Made with <span>âœ±</span> by <span2><b>@XVISpawn</b></span2></p>

    <!-- Feedback form -->
    <form id="feedbackForm">
      <textarea name="message" placeholder="Write your complaint here..."></textarea>
      <input type="hidden" name="star_rating" id="star-rating">
      <br>
      <input type="submit" value="Submit">
    </form>

    <div id="responseMessage"></div> <!-- Area to display response -->

    <p2 xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
      <span property="dct:title">CFPersonal</span> by <span property="cc:attributionName">XVISpawn</span> is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;color:white;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a>
    </p2>
  </div>

  <script>
    // Handling the star rating
    const stars = document.querySelectorAll('.star');
    const starRatingInput = document.getElementById('star-rating');

    stars.forEach(star => {
      star.addEventListener('click', () => {
        const index = star.getAttribute('data-index');
        
        // Update the stars based on the clicked star's index
        stars.forEach(star => {
          if (star.getAttribute('data-index') <= index) {
            star.classList.add('checked');
          } else {
            star.classList.remove('checked');
          }
        });

        // Set the hidden input's value to the number of stars selected
        starRatingInput.value = index;
      });

      // Hover effect: add opacity change
      star.addEventListener('mouseenter', () => {
        star.style.opacity = 0.7;
      });

      star.addEventListener('mouseleave', () => {
        star.style.opacity = 1;
      });
    });

    // Handling form submission via AJAX
    document.getElementById('feedbackForm').addEventListener('submit', async function(event) {
      event.preventDefault(); // Prevent default form submission

      const formData = new FormData(this); // Create FormData object from the form
      const responseMessage = document.getElementById('responseMessage'); // Div to show response

      try {
        // Send the form data using the fetch API
        const response = await fetch('http://multi-rewards.gl.at.ply.gg:53094/submit', {
          method: 'POST',
          body: formData, // The form data goes in the body of the request
        });

        if (response.ok) {
          const text = await response.text(); // Get the response text
          responseMessage.textContent = text; // Display success message
          responseMessage.style.color = 'green';
        } else {
          responseMessage.textContent = 'Error submitting feedback. Please try again.'; // Error message
          responseMessage.style.color = 'red';
        }
      } catch (error) {
        responseMessage.textContent = 'An error occurred. Please try again.'; // Network error
        responseMessage.style.color = 'red';
        console.error('Error:', error);
      }
    });
  </script>
</body>
</html>
